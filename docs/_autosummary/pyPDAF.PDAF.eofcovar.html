<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pyPDAF.PDAF.eofcovar &#8212; pyPDAF  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=8203d6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pyPDAF.PDAF.sample_ens" href="pyPDAF.PDAF.sample_ens.html" />
    <link rel="prev" title="pyPDAF.PDAF.diag_crps_nompi" href="pyPDAF.PDAF.diag_crps_nompi.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="pypdaf-pdaf-eofcovar">
<h1>pyPDAF.PDAF.eofcovar<a class="headerlink" href="#pypdaf-pdaf-eofcovar" title="Link to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="pyPDAF.PDAF.eofcovar">
<span class="sig-prename descclassname"><span class="pre">pyPDAF.PDAF.</span></span><span class="sig-name descname"><span class="pre">eofcovar</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyPDAF.PDAF.eofcovar" title="Link to this definition">¶</a></dt>
<dd><p>EOF analysis of an ensemble of state vectors by singular value decomposition.</p>
<p>Typically, this function is used with <code class="xref py py-func docutils literal notranslate"><span class="pre">pyPDAF.PDAF.SampleEns()</span></code>
to generate an ensemble of a chosen size (up to the number of EOFs plus one).</p>
<p>Here, the function performs a singular value decomposition
of the ensemble anomaly of the input matrix,
which is usually an ensemble formed by state vectors
at multiple time steps.
The singular values and corresponding singular vectors
can be used to construct a covariance matrix.
This can be used as the initial error covariance for the initial ensemble.</p>
<p>A multivariate scaling can be performed to ensure that all fields
in the state vectors have unit variance.</p>
<p>It can be useful to store more EOFs than one finally
might want to use to have the flexibility
to carry the ensemble size.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://pdaf.awi.de/trac/wiki/EnsembleGeneration">PDAF webpage</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<em>int</em>) – Dimension of state vector</p></li>
<li><p><strong>nstates</strong> (<em>int</em>) – Number of state vectors</p></li>
<li><p><strong>nfields</strong> (<em>int</em>) – Number of fields in state vector</p></li>
<li><p><strong>dim_fields</strong> (<em>ndarray</em><em>[</em><em>np.intc</em><em>, </em><em>ndim=1</em><em>]</em>) – Size of each field
Array shape: (nfields)</p></li>
<li><p><strong>offsets</strong> (<em>ndarray</em><em>[</em><em>np.intc</em><em>, </em><em>ndim=1</em><em>]</em>) – Start position of each field
Array shape: (nfields)</p></li>
<li><p><strong>remove_mstate</strong> (<em>int</em>) – 1: subtract mean state from states</p></li>
<li><p><strong>do_mv</strong> (<em>int</em>) – 1: Do multivariate scaling; 0: no scaling</p></li>
<li><p><strong>states</strong> (<em>ndarray</em><em>[</em><em>np.float64</em><em>, </em><em>ndim=2</em><em>]</em>) – State perturbations
Array shape: (dim, nstates)</p></li>
<li><p><strong>meanstate</strong> (<em>ndarray</em><em>[</em><em>np.float64</em><em>, </em><em>ndim=1</em><em>]</em>) – Mean state (only changed if remove_mstate=1)
Array shape: (dim)</p></li>
<li><p><strong>verbose</strong> (<em>int</em>) – Verbosity flag</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>states</strong> (<em>ndarray[np.float64, ndim=2]</em>) – State perturbations
Array shape: (dim, nstates)</p></li>
<li><p><strong>stddev</strong> (<em>ndarray[np.float64, ndim=1]</em>) – Standard deviation of field variability
Array shape: (nfields)</p></li>
<li><p><strong>svals</strong> (<em>ndarray[np.float64, ndim=1]</em>) – Singular values divided by sqrt(nstates-1)
Array shape: (nstates)</p></li>
<li><p><strong>svec</strong> (<em>ndarray[np.float64, ndim=2]</em>) – Singular vectors
Array shape: (dim, nstates)</p></li>
<li><p><strong>meanstate</strong> (<em>ndarray[np.float64, ndim=1]</em>) – Mean state (only changed if remove_mstate=1)
Array shape: (dim)</p></li>
<li><p><strong>status</strong> (<em>int</em>) – Status flag</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">pyPDAF</a></h1>



<p class="blurb">A Python interface to Parallel Data Assimilation Framework.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=yumengch&repo=pyPDAF&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel.html">Parallelisation Strategy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop.html">Developer Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../API.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../API.html#initialisation-and-finalisation">Initialisation and finalisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API.html#da-algorithms">DA algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API.html#omi-functions">OMI functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API.html#localisation-functions">Localisation functions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../API.html#utilities">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hidden_functions.html">Legacy and internal PDAF functions</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../API.html">API</a><ul>
      <li>Previous: <a href="pyPDAF.PDAF.diag_crps_nompi.html" title="previous chapter">pyPDAF.PDAF.diag_crps_nompi</a></li>
      <li>Next: <a href="pyPDAF.PDAF.sample_ens.html" title="next chapter">pyPDAF.PDAF.sample_ens</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2022 University of Reading and National Centre for Earth Observation.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.3.0</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/_autosummary/pyPDAF.PDAF.eofcovar.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>